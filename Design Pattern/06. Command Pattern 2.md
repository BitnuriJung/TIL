<br/>

# 느낀점
- 안드로이드 만들때 그렇게 신나게 썼던 이벤트 리스너가 커맨드 패턴을 사용하고 있는 거였다니!
- 밥 메뉴를 일요일에 싹 정해두고 일주일 내내 그대로 먹기만 하면 메뉴 고르는 스트레스가 줄어들고 다른 것을 고민할 시간이 많이 생기는 것처럼, 인보커도 execute만 실행하면 되니까 다양한 확장, 응용이 가능해지는군
- 두 번에 나눠서 하길 정말 잘한듯. 아니었으면 내용 받아들이는데만 허덕허덕해서 제대로 이해하고 넘기기 어려웠을 것 같다.

<br/><br/>

# 정리

### 커맨드 패턴에 대한 이해

- 커맨드 패턴은 요청을 캡슐화 한다
- 인보커 - 커맨드 - 리시버
- 커맨드가 가운데 껴서 인보커와 리시버를 분리해주고, 인보커에서 리시버의 존재를 모르도록 한다
- 이 덕에 인보커에서 리시버가 무슨 애인지, 뭘 하는지 전혀 신경쓰지 않고 커맨드만 관리할 수 있게 된다!
- 커맨드만 관리하면서 다양한 확장, 응용이 가능해진다
    - Undo
    - 매크로 커맨드 돌리기 (커맨드 인터페이스를 사용하므로 가능하다)
    - 작업 큐에 활용 (리시버 관계 없이 커맨드를 줄세워서 여러 스레드에 보내버리고 처리를 맡길 수 있다)
    - 로그 작성 (커맨드에 store, load 함수를 추가한다. 직접 메모리에 저장하지 않고 실행된 상태들을 보관할 수 있다)
    - 트랜잭션 (로그에서 더 나아가 특정 커맨드 묶음이 다 실행되도록 확인하거나 다 되돌려버릴 수 있다)
    - EventListener (리스너 구상 클래스가 커맨드 객체)

<br/>

### 커맨드 패턴 확장

- 작업 취소하기
    
    ```java
    // 커맨드 인터페이스에 undo() 함수를 추가한다. 
    public interface Command{
    
    	public void execute();
    	public void undo();
    		
    }
    // 커맨드를 구현한 구상 클래스들에서 undo() 함수 추가
    // execute() 때 실행한 리시버의 함수를 취소하는 함수를 정의한다.
    
    public class lightOnCommand implements Command {
    	Light light;
    	
    	execute(){
    		light.on();
    	}
    	
    	undo(){
    		light.off();
    	}
    }
    
    // 인보커에서는 취소용 커맨드 변수를 따로 선언하고(`Command undoCommand`;) 
    // 커맨드 execute() 실행 부분에 취소용 커맨드를 저장하도록 한다.
    public class RemoteController {
    	Command[] onCommands;
    	Command[] offCommands;
    	Command undoCommand;
    	
    	public void onButtonPressed(int slot){
    		onCommand[slot].execute();
    		undoCommand = onCommand[slot];
    	}
    	
    	// 인보커 취소 함수 실행시, 취소용 커맨드 변수를 사용해 작업을 취소한다 
    	public void undoButtondPressed(){
    		undoCommand.undo();
    	}
    }
    ```
    
    - 만약 on, off 처럼 심플하지 않고 여러 상태값을 가질 수 있는 리시버라면
        - 선풍기 리시버가 있고, 함수가 on, low, medium, high (각각 설정하는 속도가 다름) 이라면
        - 선풍기 클래스에 속도값을 반환하는 게터 함수를 추가한다. (`getSpeed()`)
        - 구상 커맨드에 선풍기의 이전 속도값을 저장하는 변수를 추가한다. (`Int prevSpeed`)
        - `execute`실행 전, 선풍기 리시버의 이전 속도값을 가져와 이전 속도값 변수에 저장한다
        - `undo()` 실행시 이전 속도값 변수에 맞게 선풍기 속도가 정해지도록 하면 된다~
    - 취소를 여러번 하고 싶다면 커맨드 자체를 Stack 에 저장하면 간단하다는데 스택에 저장한다는 말이 정확히 뭘 말하는걸까? 🤔
    
- 매크로 작업 돌리기
    - 리모컨 버튼 하나로 TV, 조명, 욕조까지 관리해보자
    - 매크로 커맨드 클래스를 새로 만든다
    - 커맨드 배열을 가지고 있다. 생성자로 받아준다 `Command[] commands;`
    - `execute()`-> 커맨드 배열 내부의 첨부터 끝까지 `commands[i].execute();`
    - Undo 함수도 마찬가지
    - 클라이언트에서 커맨드 배열을 만들고, 매크로 커맨드에 넣어준다
    - 매크로 커맨드를 리모컨 객체 슬롯에 넣어주면 끗

<br/>

### 커맨드 패턴 응용

- 작업 큐
- 로그
- 이벤트 리스너

<br/>

# 추가공부

- Queue 와 Stack
    - 둘 다 자료구조다
    - 큐
        - 줄서기라는 뜻. 말 그대로라서 새치기를 싫어한다
        - 맨 처음 줄 선 친구가 맨 처음 나간다
        - 줄을 추가해주는 쪽과 내보내는 쪽 두 가지 처리가 필요하다
        - 편의점 맥주를 생각하면 된다.
            - 직원이 넣기만 하는 쪽과 손님이 가져가기만 하는 쪽이 있음
            - 먼저 넣은 맥주를 먼저 가져감.
    - 스택
        - 쌓는다는 뜻. 쌓으면 위에부터 가져갈수밖에 없다.
        - 맨 처음 들어간 친구는 마지막에 나온다.
        - 추가하고 내보내는 처리를 한쪽에서만 한다.
        - 창고에 나무 판자를 쌓아두는 모습을 생각하면 된다.
            - 바닥에 있는거 들어내서 가져가는 짓을 한다면 아마 다들 개싫어할것이다..
    - 자바의 메모리 중 힙, 스택 메모리가 있다. 이것은 또 추가공부를 진행해야 한다.